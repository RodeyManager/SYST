(function(e){"use strict";var t=this,e={};e="undefined"!=typeof exports?exports:t.SYST={},e.version="0.0.5",e.author="Rodey Luo",e.name="SYST JS MVC mini Framework (JS MVC框架)",e.noConflict=function(){return t.SYST=e,this};try{e.$=t.jQuery||t.Zepto||t.ender||void 0}catch(n){throw new Error("$不存在，请先引入jQuery|Zepto|Ender插件，依赖其中一个。"+n)}try{e.template=t.template||t._||void 0}catch(n){throw new Error("模板解析对象不存在，请先引入arttemplate|underscore插件，依赖其中一个"+n)}var r=function(e,t){if(!e)return t;if(!t)return e;if(!t.prototype){t.__super__=e;var n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n])}return t},i=function(e){var t,n=e,r={};for(t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);return r},o=function(e,t){var n=[];e=e||window;for(var r=2;r<arguments.length;r++)n.push(arguments[r]);return function(r){if(r&&"object"==typeof r&&(r.preventDefault(),r.stopPropagation()),n.push(r),!e[t])throw new Error(t+" 函数未定义！");e[t].call(e,r,n)}};e.extend=r,e.clone=i,e.hoadEvent=o,"function"==typeof define?define(function(){return e}):"undefined"!=typeof exports&&(module.exports=e),t.SYST=e}).call(this),function(e){"use strict";e.Events=function(t,n,r,i,o,a){var o=o||"on",s="abort reset click dblclick tap touchstart touchmove touchend change mouseover mouseout mouseup mousedown mousemove mousewheel drag dragend dragenter dragleave dragover dragstart drop resize scroll submit select keydown keyup keypress touchstart touchend load unload blur focus contextmenu formchange forminput input invalid afterprint beforeprint beforeonload haschange message offline online pagehide pageshow popstate redo storage undo canplay canplaythrough durationchange emptied ended loadeddata loadedmetadata loadstart pause play playing progress ratechange readystatechange seeked seeking stalled suspend timeupdate volumechange waiting cut copy paste".split(/\s+/gi);t||(t=window);for(var u=0;u<s.length;u++)s[u]===r&&("window"==t.selector?"on"==o?$(window).off().on(r,e.hoadEvent(n,i)):$(window).off(r,e.hoadEvent(n,i)):"document"==t.selector||"html"==t.selector||"body"==t.selector?"on"==o?$(t.selector).off().on(r,e.hoadEvent(n,i)):$(t.selector).off(r,e.hoadEvent(n,i)):"on"==o?$(a||"body").undelegate(t.selector,r,e.hoadEvent(n,i)).delegate(t.selector,r,e.hoadEvent(n,i)):$(a||"body").undelegate(t.selector,r,e.hoadEvent(n,i)))}}(SYST),function(e){"use strict";e._shareModels=[];e.shareModel={add:function(t){e._shareModels.push(t)},get:function(t){if(null==t)return e._shareModels;for(var n=0;n<e._shareModels.length;++n)if(t==e._shareModels[n])return e._shareModels[n];return null},remove:function(t){return e.T.arrRemove(e._shareModels,t),e._shareModels},has:function(t){return-1!==e.T.indexOf(e._shareModels,t)}}}(SYST),function(e){"use strict";e.Validate=function(t){return this.__Name__="Validate",t?(t.__SuperName__="SYST Validate",t=e.extend(e.Validate.prototype,t)):new e.Validate({})};e.V=e.Validate.prototype={isEmpty:function(e){return e&&0!==e.length&&""!==e&&null!=e?!1:!0},isSet:function(e){return"undefined"!=typeof e?!0:!1},between:function(e,t,n,r){return r=r||!1,r?e.length>=t&&e.length<=n?!0:!1:e.length>t&&e.length<n?!0:!1},isCN:function(e,t){return t?/^[\u4e00-\u9fa5]+$/.test(e):/[\u4e00-\u9fa5]+/gi.test(e)},isEmail:function(e){return/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/gi.test(e)},isURL:function(e){return/^http:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/i.test(e)},isTel:function(e){return/^(\(\d{3,4}\)|\d{3,4}-)?\d{7,8}$/gi.test(e)},isMobile:function(e){return/^1[3|4|5|7|8]{1}\d{9}$/.test(e)},isZip:function(e){return/^\d{6}$/.test(e)},isDateLocal:function(e){return/^(\d{4})-(\d{1,2})-(\d{1,2})$/.test(e)},isDateTime:function(e){return/^(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})$/.test(e)},isTime:function(e){return/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/.test(e)},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isArray:function(e){return"[object Array]"===toString.call(e)},isDate:function(e){return"[object Date]"===toString.call(e)},isObject:function(e){return null!=e&&"object"==typeof e},isFunction:function(e){return"function"==typeof e},isFile:function(e){return"[object File]"===toString.call(e)},isBlob:function(e){return"[object Blob]"===toString.call(e)},isBoolean:function(e){return"boolean"==typeof e},isdefined:function(e){return"undefined"!=typeof e},isRegExp:function(e){return"[object RegExp]"===toString.call(e)},isWindow:function(e){return e&&e.document&&e.location&&e.alert&&e.setInterval},isElement:function(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}}}(SYST),function(e){"use strict";e.Tools=function(t){return this.__Name__="Tools",t?(t.__SuperName__="SYST Tools",t=e.extend(e.Tools.prototype,t)):new e.Tools({})};e.T=e.Tools.prototype={template:function(e,t){var n=document.createElement(t||"div");return n.innerHTML=e,$?($(n).html(e),$(n)[0]):n.childNodes},trigger:function(e,t,n,r){if(e&&t&&""!==t)try{e[method].call(e,n,arguments),"function"==typeof r&&r.call(e,n)}catch(i){throw new Error(e+"不存在"+t+"方法 <::>")}},trim:function(e){return e.replace(/^\s*|\s*$/gi,"")},rtrim:function(e,t,n){if(t){var r;return r=n?new RegExp("\\"+t+"*","gi"):new RegExp("^(\\"+t+")*|(\\"+t+")*$","gi"),e.replace(r,"")}return this.trim(e)},indexOf:function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1},arrRemove:function(e,t){var n=this.indexOf(e,t);return n>=0&&e.splice(n,1),t},F2C:function(e){for(var t="",e=e.replace(/\s*/gi,""),n=0;n<e.length;n++){var r=e.charCodeAt(n);t+=12288!=r?r>65280&&65375>r?String.fromCharCode(r-65248):String.fromCharCode(r):String.fromCharCode(32)}return t=t.replace(/\s*/gi,""),t.toUpperCase()},dateFm:function(e){return 10>e?"0"+e:e},setDateFormat:function(t,n,r){function i(e,t){t.push(r?o.dateFm(e):e)}if(e.V.isEmpty(t))return"";var o=this,a=new Date(parseInt(t,10)),s=[],u=[];if(!n)return a.getFullYear()+"-"+this.dateFm(a.getMonth()+1)+"-"+this.dateFm(a.getDate())+" "+this.dateFm(a.getHours())+":"+this.dateFm(a.getMinutes())+":"+this.dateFm(a.getSeconds());var c=n.match(/[^\w\d\s]+?/i),l=c[0]||"-",d=c[1]||":";return/y+?/i.test(n)&&i(a.getFullYear(),s),/m+?/i.test(n)&&i(a.getMonth()+1,s),/d+?/i.test(n)&&i(a.getDate(),s),/h+?/i.test(n)&&i(a.getHours(),u),/i+?/i.test(n)&&i(a.getMinutes(),u),/s+?/i.test(n)&&i(a.getSeconds(),u),e.T.trim(s.join(l)+(u.length>0?" "+u.join(d):""))},daysBetween:function(e,t,n){var r=e.substring(5,e.lastIndexOf("-")),i=e.substring(e.length,e.lastIndexOf("-")+1),o=e.substring(0,e.indexOf("-")),a=t.substring(5,t.lastIndexOf("-")),s=t.substring(t.length,t.lastIndexOf("-")+1),u=t.substring(0,t.indexOf("-")),c=(Date.parse(r+"/"+i+"/"+o)-Date.parse(a+"/"+s+"/"+u))/864e5;return n&&"function"==typeof n?void n(c):c},params:function(t,n){if(this._pars&&this._pars[t])return this._pars[t];var r="";if(r=e.V.isEmpty(n)?window.location.search.substr(1):n.split("?")[1]||"",e.V.isEmpty(r))return{};var i=r.replace(/^\?/,"").split("&");if(!i||[]===i)return{};for(var o=0,a=i.length,s={};a>o;++o){var u=i[o].split("=");u[0]&&""!==u[0]&&Object.defineProperty(s,u[0],{value:decodeURI(u[1])||null,writable:!0,enumerable:!0,configurable:!0})}return this._pars=s,t?decodeURI(s[t]):s},getParams:function(t,n){var r=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),i="";return i=e.V.isEmpty(n)?window.location.search.substr(1).match(r):(n.split("?")[1]||"").match(r),i?decodeURI(i[2]):null},paramData:function(t,n){if(e.V.isEmpty(t)||!e.V.isObject(t))return"";var r=t,i="";for(var o in r)i+="&"+o+"="+encodeURI(r[o]);return i=i.substr(1),n===!0?"?"+i:i},Cookie:function(e,t,n){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(t))||null===t||void 0===t)){if(n=n||{},(null===t||void 0===t)&&(n.expires=-1),"number"==typeof n.expires){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}return t=String(t),document.cookie=[encodeURIComponent(e),"=",n.raw?t:encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=t||{};for(var o,a=n.raw?function(e){return e}:decodeURIComponent,s=document.cookie.split("; "),u=0;o=s[u]&&s[u].split("=");u++)if(a(o[0])===e)return a(o[1]||"");return null}}}(SYST),function(e){"use strict";e.tplConfig={open:"<%",close:"%>"};var t=/^\s*|\s*$/i,n=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,r=function(t,r){for(var i,o=0,a=e.tplConfig,s=new RegExp(a.open+"([^"+a.close+"]+)?"+a.close,"g"),u="var r = [];\n",c=function(e,t){return u+=t?e.match(n)?e+"\n":"r.push("+e+");\n":""!=e?'r.push("'+e.replace(/"/g,'\\"')+'");\n':"",c};i=s.exec(t);)c(t.slice(o,i.index))(i[1],!0),o=i.index+i[0].length;return c(t.substr(o,t.length-o)),u+='return r.join("");',new Function(u.replace(/[\r\t\n]/g,"")).apply(r)};e.Render=function(e,n){var i=document.querySelector("#"+e.replace("#")),o="";if(i){var a=/^(TEXTEREA|INPUT)$/i.test(i.nodeName)?i.value:i.innerHTML;o=a.replace(t,"")}else o=e.replace(t,"");try{this.cache=r(o,n)}catch(s){delete this.cache}return this.cache?this.cache:r(o,n)}}(SYST),function(e,t){"use strict";e.Model=function(t){return this.__Name__="Model",t?(t=t||{},t.__SuperName__="SYST Model",t=e.extend(e.Model.prototype,t),t._initialize(),t):new e.Model({})};e.Model.prototype={_initialize:function(){this.init&&this.init.apply(this,arguments),this.attributes={},e.shareModel.add(this)},get:function(e,t){return this.attributes[e]},set:function(e,t,n){if(null==e)return this;if(e)if("object"==typeof e)for(var r in e)this.attributes[r]=e[r];else{if(!("string"==typeof e&&e.length>0))return this;this.attributes[e]=t}},getItem:function(e,t){var n=(t?window.sessionStorage:window.localStorage).getItem(e);try{n=JSON.parse(n)}catch(r){}return n},setItem:function(t,n,r){function i(t,n){e.V.isObject(n)&&(n=JSON.stringify(n)),(r?window.sessionStorage:window.localStorage).setItem(t,n)}if(e.V.isObject(t))for(var o in t)i(o,t[o]);else{if(!("string"==typeof t&&t.length>0))return this;i(t,n)}},has:function(e){return Boolean(this.attributes[e])},hasItem:function(e,t){return Boolean((t?window.sessionStorage:window.localStorage).getItem(e))},add:function(e,t,n){this.set(e,t,n)},remove:function(e){return e&&""!=e?(this.attributes[e]=null,void delete this.attributes[e]):this},removeItem:function(e,t){(t?window.sessionStorage:window.localStorage).removeItem(e)},removeAll:function(e){e?this.attributes=[]:function(){window.localStorage.clear(),window.sessionStorage.clear()}()},_getName:function(){return this.__Name__},doRequest:function(n,r,i,o,a){var s,u,c=this,l={};if(r&&"object"==typeof r&&n&&""!=n){a?(s=a.type,u=a.dataType||c.ajaxDataType||"json",l=a):(s=c.ajaxType||"POST",u=c.ajaxDataType||"json"),c.ajaxBefore&&e.V.isFunction(c.ajaxBefore)&&(l.beforeSend=c.ajaxBefore.apply(c));var d=e.extend(l,{url:n,type:s,data:r,dataType:u,success:function(t){c.ajaxSuccess&&e.V.isFunction(c.ajaxSuccess)&&c.ajaxSuccess.call(c,t),i&&e.V.isFunction(i)&&i.call(c,t)},error:function(t,n){var r=t.response;try{r=JSON.parse(r)}catch(i){}c.ajaxError&&e.V.isFunction(c.ajaxError)&&c.ajaxError.call(c,r,t,n),o&&e.V.isFunction(o)&&o.call(c,r,t,n)},complete:function(t){c.ajaxComplete&&e.V.isFunction(c.ajaxComplete)&&c.ajaxComplete.call(c,t)}});if(!t.$)throw new Error("doRequest: $不存在，此方法依赖于(jQuery||Zepto||Ender)");t.$.ajax(d)}},doAjax:function(e,t,n,r,i){this.doRequest(e,t,n,r,i)}}}(SYST,window),function(e){var t=new XMLHttpRequest,n={dataType:"json",type:"POST",async:!0,timeout:5e3,crossDomain:!0,header:{"Content-type":"application/x-www-form-urlencoded"}},r=function(e,t){var n=e;if("json"===t)try{n=JSON.parse(e)}catch(r){}else if("text"===t)try{n=JSON.stringify(e)}catch(r){}return n},i=function(t,n,i){var o=r(t,n);e.V.isFunction(i)&&i(o)},o=function(t,n,i){e.V.isFunction(i)&&i(r(t.responseText,n),t)},a=function(r){if(e.V.isObject(r)&&(n=e.extend(r,n)),!e.V.isEmpty(n.url)){var a=n.data,s="GET"===n.type.toUpperCase()?n.url.split("?")[0]+e.T.paramData(n.data,!0):n.url,u="GET"===n.type.toUpperCase()?void 0:a,c="async"in n?n.async:!0;i(void 0,n.dataType,n.ajaxBefore),t.open(n.type,s,c);for(var l in n.header)t.setRequestHeader(l,n.header[l]);t.onreadystatechange=function(){4===t.readyState&&(t.onreadystatechange=null,200===t.status?i(t.responseText,n.dataType,n.success):i(t,n.dataType,n.error),o(t,n.dataType,n.complate))},t.send(u)}};e&&(e.ajax=a,e.Model.prototype.ajax=a)}(SYST),function(e,t){"use strict";e.View=function(t){return this.__Name__="View",t?(t.__SuperName__="SYST View",t=e.extend(e.View.prototype,t),!t.unInit&&t._initialize(),t):new e.View({})};e.View.prototype={$el:{},tagPanel:"selection",_initialize:function(){var t=this;if(this.model=this.model?this.model:this.controller?this.controller.getModel():void 0,this.init&&this.init.apply(this,arguments),this.render){var n="<"+t.tagPanel+"/>";t.$el=e.$?e.$(n):t.parseDom("",n),t.render.apply(t,arguments)}this.events&&this.events!={}&&e.V.isObject(this.events)&&this.onEvent()},destroy:function(){this.$el.remove()},handEvent:function(e,t){for(var n=this,r=[],i=2;i<arguments.length;i++)r.push(arguments[i]);return function(i){r.push(t),r.push(i),e.apply(n,r)}},hoadEvent:e.hoadEvent,parseEvent:function(t){function n(e,t,n){i.push(e),r.push(t),o.push(n)}if(!t||0==t.length||t==={})return this;var r=[],i=[],o=[];for(var a in t){var s=t[a];if(e.V.isObject(s))for(var u in s){var c=this.parseString(s,u),l=c[0],d=c[1],h=c[2];n(l,d,h)}else{var c=this.parseString(t,a),l=c[0],d=c[1],h=c[2];n(l,d,h)}}return{events:r,elements:i,functions:o}},autoHandleEvent:function(t){var n=this.parseEvent(this.events),r=n.events,i=n.elements,o=n.functions;if(!r||0==r.length||r.length=={})return this;for(var t=t||"on",a=0,s=r.length;s>a;a++){if(!r[a])throw new Error("对象侦听"+r[a]+"不存在");if(!o[a])throw new Error("对象"+this+"不存在"+o[a]+"方法");if(!i[a])throw new Error("事件函数"+o[a]+"不存在");e.Events($(i[a]),this,r[a],o[a],t,this.triggerContainer||"body")}return this},parseString:function(e,t){var n=$.trim(t).split(/\s+/gi),r=n[1].replace(/^\$*|[\(*]|[\)*]$/gi,"").replace(/"|'/gi,'"'),i=n[0].replace(/^\s*|\s*$/gi,""),o=e[t];return[r,i,o]},onEvent:function(t,n,r){e.V.isEmpty(t)?this.autoHandleEvent("on"):e.Events.initEvent(e.V.isString(t)?$(t):t,this,n,r,"on",this.triggerContainer)},offEvent:function(t,n,r){e.V.isEmpty(t)?this.autoHandleEvent("off"):e.Events.initEvent(e.V.isString(t)?$(t):t,this,n,r,"off",this.triggerContainer)},template:function(n,r){var i,o;return t.template?(o=e.template.compile(n),i=o(r)):i=t._?_.template(n,r):e.Render(n,r)},parseDom:function(t,n){return e.T.template(t,n)},getController:function(){return this.controller},getModel:function(){return this.model||this.getController().getModel()},shareModel:e.shareModels}}(SYST,window),function(e){"use strict";e.Controller=function(t){return this.__Name__="Controller",this.model=void 0,this.superView=void 0,this.shareModels=e.shareModel.get(null),t?(t.__SuperName__="SYST Controller",t=e.extend(e.Controller.prototype,t),t._initialize(),t):new e.Controller({})};e.Controller.prototype={defaultHost:location.host,shareModel:e.shareModel,_initialize:function(){this.init&&this.init.apply(this,arguments)},getModel:function(e){return e?this.shareModel.get(e):this.model},setModel:function(e){if(""!==key||null!=e)this.shareModel.add(e);else{if("object"!=typeof key)throw"setModel: 参数有误";this.model=key}}}}(SYST),function(e){"use strict";var t=(e.Router=function(t){return this.__Name__="Router",t?(t.__SuperName__="SYST Router",t=e.extend(e.Router.prototype,t)):new e.Router({})},window.location),n=t.host,r=(t.port,t.origin||t.protocol+"//"+n,t.pathname,t.hash),i=function(e){return e.replace(/[#!]/gi,"").split("?")[0]};e.R=e.Router.prototype={_cache:{},start:function(){if(r&&""!==r){var e=i(r);this["switch"](e)}return this._change(),this},when:function(t,n){return e.V.isObject(n)?this._cache[t]=n:e.V.isFunction(n)&&(this._cache[t]=n()),this},"switch":function(t){return this._cache&&{}!==this._cache?(this.params=e.T.params(null,window.location.href),this._exec(t),this):void 0},_exec:function(e){var t=this._cache[e];this.currentRouter=t,this._onReady(),this._execRouter(t)},_execRouter:function(e){var t=this;e&&(e.template?this._template(e.template,e.container,function(n){t._execMAction(e,n),t._onRender()}):t._execMAction(e))},_execMAction:function(t,n){this.tpl=n;var r={model:t.model,tpl:n,params:this.params,router:this},i={model:t.model,tpl:n,params:this.params,router:this,view:t.view};t.model&&function(){return e.Model(t.model)}(),t.view&&function(){return e.View(e.extend(t.view,r))}(),t.controller&&function(){return e.Controller(e.extend(t.controller,i))}(),t.action&&e.V.isFunction(t.action)&&t.action.call(this,t.model,n)},_change:function(){function e(e){t.oldURL="#"+e.oldURL.split("#")[1],t.newURL="#"+e.newURL.split("#")[1];var n=i(t.newURL);t._onDestroy(function(){t["switch"](n)})}var t=this;window.removeEventListener("hashchange",e,!1),window.addEventListener("hashchange",e,!1)},_template:function(t,n,r){var i=this;this.container=$("#"+n.replace(/#/gi,"")),/<|>/g.test(t)?(this.container.html(t),r&&e.V.isFunction(r)&&r.call(i,t)):this.container.load(t,function(t){r&&e.V.isFunction(r)&&r.call(i,t)},function(e){throw new Error("load template is failed!")})},_onReady:function(){this.currentRouter&&this.currentRouter.onReady&&this.currentRouter.onReady.call(this)},_onRender:function(e){this._onAnimate("on",e),this.currentRouter&&this.currentRouter.onRender&&this.currentRouter.onRender.call(this,this.tpl)},_onDestroy:function(e){this._onAnimate("off",e),this.currentRouter&&this.currentRouter.onDestroy&&this.currentRouter.onDestroy.call(this,this.tpl)},_onAnimate:function(t,n){var r=this.currentRouter.animate,i=this.currentRouter.animateDuration||300,o=this.container,t=t||"on";if(e.V.isEmpty(r))return o.show(n),!1;if(this.currentRouter&&o)switch(r){case"slide":"on"===t?o.slideDown(i,n):o.slideUp(100,n);break;case"fade":"on"===t?o.fadeIn(i,n):o.fadeOut(100,n);break;default:o.show()}}}}(SYST),function(e){"use strict";var t=navigator.userAgent.toUpperCase(),n=-1!==t.indexOf("ANDROID"),r=-1!==t.indexOf("IPHONE OS"),i=n||r?!0:!1,o=-1!==t.indexOf("MOBILE"),a=-1!==t.indexOf("IPAD"),s=o||a?!0:!1;e.Native=function(t){return this.__Name__="Native",t?(t.__SuperName__="SYST Native",t=e.extend(e.Native.prototype,t)):new e.Native({})};e.N=e.Native.prototype={isAndroid:n,isIos:r,isNative:i,isPhone:o,isPad:a,isMobile:s,callNative:function(e){}}}(SYST);