(function(t){"use strict";var e=this,t={};t="undefined"!=typeof exports?exports:e.SYST={},t.version="0.0.5",t.author="Rodey Luo",t.name="SYST JS MVC mini Framework (JS MVC框架)",t.noConflict=function(){return e.SYST=t,this};try{t.$=e.jQuery||e.Zepto||e.ender||void 0}catch(n){throw new Error("$不存在，请先引入jQuery|Zepto|Ender插件，依赖其中一个。"+n)}try{t.template=e.template||e._||void 0}catch(n){throw new Error("模板解析对象不存在，请先引入arttemplate|underscore插件，依赖其中一个"+n)}var r=function(t,e){if(!t)return e;if(!e)return t;if(!e.prototype){e.__super__=t;var n;for(n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}return e},i=function(t){var e,n=t,r={};for(e in n)n.hasOwnProperty(e)&&(r[e]=n[e]);return r},o=function(t,e){var n=[];t=t||window;for(var r=2;r<arguments.length;r++)n.push(arguments[r]);return function(r){if(r&&"object"==typeof r&&(r.preventDefault(),r.stopPropagation()),n.push(r),!t[e])throw new Error(e+" 函数未定义！");t[e].call(t,r,n)}};t.extend=r,t.clone=i,t.hoadEvent=o,"function"==typeof define?define(function(){return t}):"undefined"!=typeof exports&&(module.exports=t),e.SYST=t}).call(this),function(t){"use strict";t.Events=function(e,n,r,i,o,s){var o=o||"on",a="abort reset click dblclick tap touchstart touchmove touchend change mouseover mouseout mouseup mousedown mousemove mousewheel drag dragend dragenter dragleave dragover dragstart drop resize scroll submit select keydown keyup keypress touchstart touchend load unload blur focus contextmenu formchange forminput input invalid afterprint beforeprint beforeonload haschange message offline online pagehide pageshow popstate redo storage undo canplay canplaythrough durationchange emptied ended loadeddata loadedmetadata loadstart pause play playing progress ratechange readystatechange seeked seeking stalled suspend timeupdate volumechange waiting cut copy paste".split(/\s+/gi);e||(e=window);for(var u=0;u<a.length;u++)a[u]===r&&("window"==e.selector?"on"==o?$(window).off().on(r,t.hoadEvent(n,i)):$(window).off(r,t.hoadEvent(n,i)):"document"==e.selector||"html"==e.selector||"body"==e.selector?"on"==o?$(e.selector).off().on(r,t.hoadEvent(n,i)):$(e.selector).off(r,t.hoadEvent(n,i)):"on"==o?$(s||"body").undelegate(e.selector,r,t.hoadEvent(n,i)).delegate(e.selector,r,t.hoadEvent(n,i)):$(s||"body").undelegate(e.selector,r,t.hoadEvent(n,i)))}}(SYST),function(t){"use strict";t._shareModels=[];t.shareModel={add:function(e){t._shareModels.push(e)},get:function(e){if(null==e)return t._shareModels;for(var n=0;n<t._shareModels.length;++n)if(e==t._shareModels[n])return t._shareModels[n];return null},remove:function(e){return t.T.arrRemove(t._shareModels,e),t._shareModels},has:function(e){return-1!==t.T.indexOf(t._shareModels,e)}}}(SYST),function(t){"use strict";t.Validate=function(e){return this.__Name__="Validate",e?(e.__SuperName__="SYST Validate",e=t.extend(t.Validate.prototype,e)):new t.Validate({})};t.V=t.Validate.prototype={isEmpty:function(t){return t&&0!==t.length&&""!==t&&null!=t?!1:!0},isSet:function(t){return"undefined"!=typeof t?!0:!1},between:function(t,e,n,r){return r=r||!1,r?t.length>=e&&t.length<=n?!0:!1:t.length>e&&t.length<n?!0:!1},isCN:function(t,e){return e?/^[\u4e00-\u9fa5]+$/.test(t):/[\u4e00-\u9fa5]+/gi.test(t)},isEmail:function(t){return/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/gi.test(t)},isURL:function(t){return/^http:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/i.test(t)},isTel:function(t){return/^(\(\d{3,4}\)|\d{3,4}-)?\d{7,8}$/gi.test(t)},isMobile:function(t){return/^1[3|4|5|7|8]{1}\d{9}$/.test(t)},isZip:function(t){return/^\d{6}$/.test(t)},isDateLocal:function(t){return/^(\d{4})-(\d{1,2})-(\d{1,2})$/.test(t)},isDateTime:function(t){return/^(\d{4})-(\d{1,2})-(\d{1,2})\s+(\d{1,2}):(\d{1,2}):(\d{1,2})$/.test(t)},isTime:function(t){return/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/.test(t)},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:function(t){return"[object Array]"===toString.call(t)},isDate:function(t){return"[object Date]"===toString.call(t)},isObject:function(t){return null!=t&&"object"==typeof t},isFunction:function(t){return"function"==typeof t},isFile:function(t){return"[object File]"===toString.call(t)},isBlob:function(t){return"[object Blob]"===toString.call(t)},isBoolean:function(t){return"boolean"==typeof t},isdefined:function(t){return"undefined"!=typeof t},isRegExp:function(t){return"[object RegExp]"===toString.call(t)},isWindow:function(t){return t&&t.document&&t.location&&t.alert&&t.setInterval},isElement:function(t){return!(!t||!(t.nodeName||t.prop&&t.attr&&t.find))}}}(SYST),function(t){"use strict";t.Tools=function(e){return this.__Name__="Tools",e?(e.__SuperName__="SYST Tools",e=t.extend(t.Tools.prototype,e)):new t.Tools({})};t.T=t.Tools.prototype={template:function(t,e){var n=document.createElement(e||"div");return n.innerHTML=t,$?($(n).html(t),$(n)[0]):n.childNodes},trigger:function(t,e,n,r){if(t&&e&&""!==e)try{t[method].call(t,n,arguments),"function"==typeof r&&r.call(t,n)}catch(i){throw new Error(t+"不存在"+e+"方法 <::>")}},trim:function(t){return t.replace(/^\s*|\s*$/gi,"")},rtrim:function(t,e,n){if(e){var r;return r=n?new RegExp("\\"+e+"*","gi"):new RegExp("^(\\"+e+")*|(\\"+e+")*$","gi"),t.replace(r,"")}return this.trim(t)},indexOf:function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(e===t[n])return n;return-1},arrRemove:function(t,e){var n=this.indexOf(t,e);return n>=0&&t.splice(n,1),e},F2C:function(t){for(var e="",t=t.replace(/\s*/gi,""),n=0;n<t.length;n++){var r=t.charCodeAt(n);e+=12288!=r?r>65280&&65375>r?String.fromCharCode(r-65248):String.fromCharCode(r):String.fromCharCode(32)}return e=e.replace(/\s*/gi,""),e.toUpperCase()},dateFm:function(t){return 10>t?"0"+t:t},setDateFormat:function(e,n,r){function i(t,e){e.push(r?o.dateFm(t):t)}if(t.V.isEmpty(e))return"";var o=this,s=new Date(parseInt(e,10)),a=[],u=[];if(!n)return s.getFullYear()+"-"+this.dateFm(s.getMonth()+1)+"-"+this.dateFm(s.getDate())+" "+this.dateFm(s.getHours())+":"+this.dateFm(s.getMinutes())+":"+this.dateFm(s.getSeconds());var c=n.match(/[^\w\d\s]+?/i),l=c[0]||"-",d=c[1]||":";return/y+?/i.test(n)&&i(s.getFullYear(),a),/m+?/i.test(n)&&i(s.getMonth()+1,a),/d+?/i.test(n)&&i(s.getDate(),a),/h+?/i.test(n)&&i(s.getHours(),u),/i+?/i.test(n)&&i(s.getMinutes(),u),/s+?/i.test(n)&&i(s.getSeconds(),u),t.T.trim(a.join(l)+(u.length>0?" "+u.join(d):""))},daysBetween:function(t,e,n){var r=t.substring(5,t.lastIndexOf("-")),i=t.substring(t.length,t.lastIndexOf("-")+1),o=t.substring(0,t.indexOf("-")),s=e.substring(5,e.lastIndexOf("-")),a=e.substring(e.length,e.lastIndexOf("-")+1),u=e.substring(0,e.indexOf("-")),c=(Date.parse(r+"/"+i+"/"+o)-Date.parse(s+"/"+a+"/"+u))/864e5;return n&&"function"==typeof n?void n(c):c},params:function(e,n){if(this._pars&&this._pars[e])return this._pars[e];var r="";if(r=t.V.isEmpty(n)?window.location.search.substr(1):n.split("?")[1]||"",t.V.isEmpty(r))return{};var i=r.replace(/^\?/,"").split("&");if(!i||[]===i)return{};for(var o=0,s=i.length,a={};s>o;++o){var u=i[o].split("=");u[0]&&""!==u[0]&&Object.defineProperty(a,u[0],{value:decodeURI(u[1])||null,writable:!0,enumerable:!0,configurable:!0})}return this._pars=a,e?decodeURI(a[e]):a},getParams:function(e,n){var r=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),i="";return i=t.V.isEmpty(n)?window.location.search.substr(1).match(r):(n.split("?")[1]||"").match(r),i?decodeURI(i[2]):null},paramData:function(e,n){if(t.V.isEmpty(e)||!t.V.isObject(e))return"";var r=e,i="";for(var o in r)i+="&"+o+"="+encodeURI(r[o]);return i=i.substr(1),n===!0?"?"+i:i},Cookie:function(t,e,n){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(e))||null===e||void 0===e)){if(n=n||{},(null===e||void 0===e)&&(n.expires=-1),"number"==typeof n.expires){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}return e=String(e),document.cookie=[encodeURIComponent(t),"=",n.raw?e:encodeURIComponent(e),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=e||{};for(var o,s=n.raw?function(t){return t}:decodeURIComponent,a=document.cookie.split("; "),u=0;o=a[u]&&a[u].split("=");u++)if(s(o[0])===t)return s(o[1]||"");return null}}}(SYST),function(t){"use strict";t.tplConfig={open:"<%",close:"%>"};var e=/^\s*|\s*$/i,n=/(^( )?(if|for|else|switch|case|break|{|}))(.*)?/g,r=function(e,r){for(var i,o=0,s=t.tplConfig,a=new RegExp(s.open+"([^"+s.close+"]+)?"+s.close,"g"),u="var r = [];\n",c=function(t,e){return u+=e?t.match(n)?t+"\n":"r.push("+t+");\n":""!=t?'r.push("'+t.replace(/"/g,'\\"')+'");\n':"",c};i=a.exec(e);)c(e.slice(o,i.index))(i[1],!0),o=i.index+i[0].length;return c(e.substr(o,e.length-o)),u+='return r.join("");',new Function(u.replace(/[\r\t\n]/g,"")).apply(r)};t.Render=function(t,n){var i=document.querySelector("#"+t.replace("#")),o="";if(i){var s=/^(TEXTEREA|INPUT)$/i.test(i.nodeName)?i.value:i.innerHTML;o=s.replace(e,"")}else o=t.replace(e,"");try{this.cache=r(o,n)}catch(a){delete this.cache}return this.cache?this.cache:r(o,n)}}(SYST),function(t,e){"use strict";t.Model=function(e){return this.__Name__="Model",e?(e=e||{},e.__SuperName__="SYST Model",e=t.extend(t.Model.prototype,e),e._initialize(),e):new t.Model({})};t.Model.prototype={_initialize:function(){this.init&&this.init.apply(this,arguments),this.attributes={},t.shareModel.add(this)},get:function(t,e){return this.attributes[t]},set:function(t,e,n){if(null==t)return this;if(t)if("object"==typeof t)for(var r in t)this.attributes[r]=t[r];else{if(!("string"==typeof t&&t.length>0))return this;this.attributes[t]=e}},getItem:function(t,e){var n=(e?window.sessionStorage:window.localStorage).getItem(t);try{n=JSON.parse(n)}catch(r){}return n},setItem:function(e,n,r){function i(e,n){t.V.isObject(n)&&(n=JSON.stringify(n)),(r?window.sessionStorage:window.localStorage).setItem(e,n)}if(t.V.isObject(e))for(var o in e)i(o,e[o]);else{if(!("string"==typeof e&&e.length>0))return this;i(e,n)}},has:function(t){return Boolean(this.attributes[t])},hasItem:function(t,e){return Boolean((e?window.sessionStorage:window.localStorage).getItem(t))},add:function(t,e,n){this.set(t,e,n)},remove:function(t){return t&&""!=t?(this.attributes[t]=null,void delete this.attributes[t]):this},removeItem:function(t,e){(e?window.sessionStorage:window.localStorage).removeItem(t)},removeAll:function(t){t?this.attributes=[]:function(){window.localStorage.clear(),window.sessionStorage.clear()}()},_getName:function(){return this.__Name__},doRequest:function(n,r,i,o,s){var a,u,c=this,l={};if(r&&"object"==typeof r&&n&&""!=n){s?(a=s.type,u=s.dataType||c.ajaxDataType||"json",l=s):(a=c.ajaxType||"POST",u=c.ajaxDataType||"json"),c.ajaxBefore&&t.V.isFunction(c.ajaxBefore)&&(l.beforeSend=c.ajaxBefore.apply(c));var d=t.extend(l,{url:n,type:a,data:r,dataType:u,success:function(e){c.ajaxSuccess&&t.V.isFunction(c.ajaxSuccess)&&c.ajaxSuccess.call(c,e),i&&t.V.isFunction(i)&&i.call(c,e)},error:function(e,n){var r=e.response;try{r=JSON.parse(r)}catch(i){}c.ajaxError&&t.V.isFunction(c.ajaxError)&&c.ajaxError.call(c,r,e,n),o&&t.V.isFunction(o)&&o.call(c,r,e,n)},complete:function(e){c.ajaxComplete&&t.V.isFunction(c.ajaxComplete)&&c.ajaxComplete.call(c,e)}});if(!e.$)throw new Error("doRequest: $不存在，此方法依赖于(jQuery||Zepto||Ender)");e.$.ajax(d)}},doAjax:function(t,e,n,r,i){this.doRequest(t,e,n,r,i)}}}(SYST,window),function(t){var e=new XMLHttpRequest,n={dataType:"json",type:"POST",async:!0,timeout:5e3,crossDomain:!0,header:{"Content-type":"application/x-www-form-urlencoded"}},r=function(t,e){var n=t;if("json"===e)try{n=JSON.parse(t)}catch(r){}else if("text"===e)try{n=JSON.stringify(t)}catch(r){}return n},i=function(e,n,i){var o=r(e,n);t.V.isFunction(i)&&i(o)},o=function(e,n,i){t.V.isFunction(i)&&i(r(e.responseText,n),e)},s=function(r){if(t.V.isObject(r)&&(n=t.extend(r,n)),!t.V.isEmpty(n.url)){var s=n.data,a="GET"===n.type.toUpperCase()?n.url.split("?")[0]+t.T.paramData(n.data,!0):n.url,u="GET"===n.type.toUpperCase()?void 0:s,c="async"in n?n.async:!0;i(void 0,n.dataType,n.ajaxBefore),e.open(n.type,a,c);for(var l in n.header)e.setRequestHeader(l,n.header[l]);e.onreadystatechange=function(){4===e.readyState&&(e.onreadystatechange=null,200===e.status?i(e.responseText,n.dataType,n.success):i(e,n.dataType,n.error),o(e,n.dataType,n.complate))},e.send(u)}};t&&(t.ajax=s,t.Model.prototype.ajax=s)}(SYST),function(t,e){"use strict";t.View=function(e){return this.__Name__="View",e?(e.__SuperName__="SYST View",e=t.extend(t.View.prototype,e),!e.unInit&&e._initialize(),e):new t.View({})};t.View.prototype={$el:{},tagPanel:"selection",_initialize:function(){var e=this;if(this.model=this.model?this.model:this.controller?this.controller.getModel():void 0,this.init&&this.init.apply(this,arguments),this.render){var n="<"+e.tagPanel+"/>";e.$el=t.$?t.$(n):e.parseDom("",n),e.render.apply(e,arguments)}this.events&&this.events!={}&&t.V.isObject(this.events)&&this.onEvent()},destroy:function(){this.$el.remove()},handEvent:function(t,e){for(var n=this,r=[],i=2;i<arguments.length;i++)r.push(arguments[i]);return function(i){r.push(e),r.push(i),t.apply(n,r)}},hoadEvent:t.hoadEvent,parseEvent:function(e){function n(t,e,n){i.push(t),r.push(e),o.push(n)}if(!e||0==e.length||e==={})return this;var r=[],i=[],o=[];for(var s in e){var a=e[s];if(t.V.isObject(a))for(var u in a){var c=this.parseString(a,u),l=c[0],d=c[1],h=c[2];n(l,d,h)}else{var c=this.parseString(e,s),l=c[0],d=c[1],h=c[2];n(l,d,h)}}return{events:r,elements:i,functions:o}},autoHandleEvent:function(e){var n=this.parseEvent(this.events),r=n.events,i=n.elements,o=n.functions;if(!r||0==r.length||r.length=={})return this;for(var e=e||"on",s=0,a=r.length;a>s;s++){if(!r[s])throw new Error("对象侦听"+r[s]+"不存在");if(!o[s])throw new Error("对象"+this+"不存在"+o[s]+"方法");if(!i[s])throw new Error("事件函数"+o[s]+"不存在");t.Events($(i[s]),this,r[s],o[s],e,this.triggerContainer||"body")}return this},parseString:function(t,e){var n=$.trim(e).split(/\s+/gi),r=n[1].replace(/^\$*|[\(*]|[\)*]$/gi,"").replace(/"|'/gi,'"'),i=n[0].replace(/^\s*|\s*$/gi,""),o=t[e];return[r,i,o]},onEvent:function(e,n,r){t.V.isEmpty(e)?this.autoHandleEvent("on"):t.Events.initEvent(t.V.isString(e)?$(e):e,this,n,r,"on",this.triggerContainer)},offEvent:function(e,n,r){t.V.isEmpty(e)?this.autoHandleEvent("off"):t.Events.initEvent(t.V.isString(e)?$(e):e,this,n,r,"off",this.triggerContainer)},template:function(n,r){var i,o;return e.template?(o=t.template.compile(n),i=o(r)):i=e._?_.template(n,r):t.Render(n,r)},parseDom:function(e,n){return t.T.template(e,n)},getController:function(){return this.controller},getModel:function(){return this.model||this.getController().getModel()},shareModel:t.shareModels}}(SYST,window),function(t){"use strict";t.Controller=function(e){return this.__Name__="Controller",this.model=void 0,this.superView=void 0,this.shareModels=t.shareModel.get(null),e?(e.__SuperName__="SYST Controller",e=t.extend(t.Controller.prototype,e),e._initialize(),e):new t.Controller({})};t.Controller.prototype={defaultHost:location.host,shareModel:t.shareModel,_initialize:function(){this.init&&this.init.apply(this,arguments)},getModel:function(t){return t?this.shareModel.get(t):this.model},setModel:function(t){if(""!==key||null!=t)this.shareModel.add(t);else{if("object"!=typeof key)throw"setModel: 参数有误";this.model=key}}}}(SYST),function(t){"use strict";var e=(t.Router=function(e){return this.__Name__="Router",e?(e.__SuperName__="SYST Router",e=t.extend(t.Router.prototype,e),this._initialize(),e):new t.Router({})},window.location),n=e.host,r=(e.port,e.origin||e.protocol+"//"+n,e.pathname,e.hash),i=("pushState"in window.history,function(t){return t.replace(/[#!]/gi,"").split("?")[0]});t.R=t.Router.prototype={_cache:{},routers:{},_initialize:function(){if(this.routers&&this.routers!=={}){var e=this.routers;for(var n in e)this._initRouters(n,e[n]);this.start()}this.init&&t.V.isFunction(this.init)&&this.init.apply(this)},_initRouters:function(t,e){this._cache[t]=e},start:function(){if(r&&""!==r){var t=i(r);this["switch"](t)}return this._change(),this},when:function(e,n){var r=this;return t.V.isObject(n)?this._initRouters(e,n):t.V.isFunction(n)&&this._initRouters(e,function(){n.apply(r,this.params)}),this},"switch":function(e){return this._cache&&{}!==this._cache?(this.params=t.T.params(null,window.location.href),this._exec(e),this):void 0},_exec:function(t){var e=this._cache[t];this.currentRouter=e,this._onReady(),this._execRouter(e)},_execRouter:function(t){var e=this;t&&(t.template?this._template(t.template,t.container,function(n){e._execMAction(t,n),e._onRender()}):e._execMAction(t))},_execMAction:function(e,n){this.tpl=n;var r={model:e.model,tpl:n,params:this.params,router:this},i={model:e.model,tpl:n,params:this.params,router:this,view:e.view};e.model&&function(){return t.Model(e.model)}(),e.view&&function(){return t.View(t.extend(e.view,r))}(),e.controller&&function(){return t.Controller(t.extend(e.controller,i))}(),e.action&&t.V.isFunction(e.action)&&e.action.call(this,e.model,n)},_change:function(){function t(t){e.oldURL="#"+t.oldURL.split("#")[1],e.newURL="#"+t.newURL.split("#")[1];var n=i(e.newURL);e._onDestroy(function(){e["switch"](n)})}var e=this;window.removeEventListener("hashchange",t,!1),window.addEventListener("hashchange",t,!1)},_template:function(e,n,r){var i=this;this.container=$("#"+n.replace(/#/gi,"")),/<|>/g.test(e)?(this.container.html(e),r&&t.V.isFunction(r)&&r.call(i,e)):this.container.load(e,function(e){r&&t.V.isFunction(r)&&r.call(i,e)},function(t){throw new Error("load template is failed!")})},_onReady:function(){this.currentRouter&&this.currentRouter.onReady&&this.currentRouter.onReady.call(this)},_onRender:function(t){this._onAnimate("on",t),this.currentRouter&&this.currentRouter.onRender&&this.currentRouter.onRender.call(this,this.tpl)},_onDestroy:function(t){this._onAnimate("off",t),this.currentRouter&&this.currentRouter.onDestroy&&this.currentRouter.onDestroy.call(this,this.tpl)},_onAnimate:function(t,e){var n=this.currentRouter;if(n){var r=n.animate,i=n.animateDuration||300,o=this.container,t=t||"on";if(n&&o)switch(r){case"slide":"on"===t?o.slideDown(i,e):o.slideUp(100,e);break;case"fade":"on"===t?o.fadeIn(i,e):o.fadeOut(100,e);break;default:o.show()}}}}}(SYST),function(t){"use strict";var e=navigator.userAgent.toUpperCase(),n=-1!==e.indexOf("ANDROID"),r=-1!==e.indexOf("IPHONE OS"),i=n||r?!0:!1,o=-1!==e.indexOf("MOBILE"),s=-1!==e.indexOf("IPAD"),a=o||s?!0:!1;t.Native=function(e){return this.__Name__="Native",e?(e.__SuperName__="SYST Native",e=t.extend(t.Native.prototype,e)):new t.Native({})};t.N=t.Native.prototype={isAndroid:n,isIos:r,isNative:i,isPhone:o,isPad:s,isMobile:a,callNative:function(t){}}}(SYST);